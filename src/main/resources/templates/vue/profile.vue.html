<template>
    <div class="columns">
        <div class="column is-offset-2 is-8">
            <div class="box">
                <h1 class="title">{{ name }}</h1>
                <hr/>
                <p class="has-text-danger" v-if="error">{{ error }}</p>
                <br/>
                <form v-on:submit.prevent="changeName" method="post">
                    <div class="field">
                        <p class="control has-icons-left">
                            <input class="input" type="text" v-model="name" placeholder="Name" required>
                            <span class="icon is-small is-left"><i class="fas fa-user"></i></span>
                        </p>
                    </div>
                    <br/>
                    <div class="field">
                        <p class="control">
                            <button type="submit" class="button is-success" :disabled="!ready">Change name</button>
                        </p>
                    </div>
                </form>
                <hr/>
                <p class="has-text-danger" v-if="error">{{ error }}</p>
                <br/>
                <form v-on:submit.prevent="changePassword" method="post">
                    <div class="field">
                        <p class="control has-icons-left">
                            <input class="input" type="password" v-model="password" minlength="8" maxlength="32" placeholder="Password" required>
                            <span class="icon is-small is-left"><i class="fas fa-lock"></i></span>
                        </p>
                    </div>

                    <div class="field">
                        <p class="control has-icons-left">
                            <input class="input" type="password" v-model="passwordConfirm" placeholder="Confirm password" required>
                            <span class="icon is-small is-left"><i class="fas fa-lock"></i></span>
                        </p>
                    </div>
                    <br/>
                    <div class="field">
                        <p class="control">
                            <button type="submit" class="button is-success" :disabled="!ready">Change password</button>
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </div>
</template>

<script>
    module.exports = {
        data: function() {
            return {
                'error': null,
                'password': '',
                'passwordConfirm': '',
                'name': '',
                'ready': true
            };
        },
        computed: {
            token() { return STORE.getters.TOKEN; }
        },
        methods: {
            'changeName': function () {
                // var self = this;
                //
                // if (self.password !== self.passwordConfirm) {
                //     self.error = "Passwords don't match.";
                //     return;
                // }
                //
                // self.ready = false;
                // axios.post("api/v1/users", {
                //     "email": self.email,
                //     "password": self.password,
                //     "password_confirm": self.passwordConfirm,
                //     "name": self.name
                // }).then(
                //     (response) => {
                //         self.success = true;
                //     },
                //     (error) => {
                //         console.log(error.response);
                //
                //         if (error.response.status === 400) {
                //             self.error = error.response.data.message;
                //         } else {
                //             self.error = 'Internal server error.';
                //         }
                //
                //         self.ready = true;
                //     }
                // )
            },
            'changePassword': function () {

            }
        }
    };
</script>